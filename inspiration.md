# 设计思想

## 游戏系统与剧本的分离

使用传统的游戏引擎常常会遇到两个问题：

- 对程序员来说非常落后原始，用它实现游戏系统极为繁琐，甚至要自行刷新界面。写出的代码往往不具有通用性，UI 设计发生较大调整时几乎要推倒重写。
- 对非程序员来说，脚本学习过于困难，游戏内容录入麻烦。不得不让程序代劳，却又增加了沟通的麻烦。

这二者都因一个问题导致：传统的引擎，系统实现和剧情录入都依托于同一套命令式的脚本系统。

命令式的脚本系统本身是很易于理解的设计，很适合不具备编程知识的人学习。但它并不适合用来实现复杂的逻辑，尤其是游戏系统。为了弥补这个缺点，这些脚本系统中往往又引入了更多的复杂命令和逻辑跳转等控制方式，最终非但没有提高多少系统实现能力，又因为复杂度的提高让许多非程序员学习难度变得很大。

AVG.js 的第一个设计便是游戏系统与剧本的分离。游戏系统最适合使用真正的编程语言实现，而非命令式的脚本语言。当游戏系统的编写从脚本中分离，脚本语言的复杂度也可以大大降低。

AVG.js 对命令式脚本做了大幅简化，使之成为一门能且只能用来表达剧情演出和内容流程的简单语言。相信游戏策划和导演在短时间学习后能够快速掌握，甚至不学习也能够参照样例「照猫画虎」完成剧情的录入和随心所欲的调整。我们称这种语言为 [故事脚本（Storyscript）](storyscript.md)。

此外，这个模块也是可替换的，你完全可以委托程序编写更加适合自己的故事表达方式，如直接读取 csv 文件作为脚本。

那么，游戏系统怎么办？

## 使用 React 更方便地编写游戏系统

AVG 至少有存读档、设置、鉴赏等诸多系统界面，更重要的是，它往往不只是简单的视觉小说，还会包含解谜、小游戏甚至战斗等复杂系统。

面对复杂的系统逻辑，过去的做法是手工「创建」每一个界面元素，处理翻页等交互时，又要手工「更新」每一个相关的界面元素，甚至是退出界面时，也要手工「删除」每一个界面元素，一不小心就会丢点什么，一不小心就是一个难以排查的 bug ……需要自行维护内容更新的引擎，跟咸鱼有什么区别？

有没有更方便的方法？当然。

之所以会出现上面的诸多难题，究其原因，是因为他们都是命令式的语法，即「告诉程序我需要它做什么」，自然需要事无巨细，告诉它全部的细节。与之相对应的是声明式的语法，你只需要描述清「我想要什么」，并把对应的数据交给它，它就能将它正确地显示出来，诸如换页等交互变化，你只要改变数据就可以了，界面如何更新是程序内部的事情。

因此，AVG.js 使用业界公认的框架 React 作为其内容搭建的基础。

使用了 React 之后，一个更大的好处就是组件化，不仅意味着你可以非常方便地修改和复用自己或他人的代码，也意味着你可以非常自由地进行功能的修改和添加。例如：`按钮组件 + 声音播放 = 带音效的按钮组件`，`文本框组件 + 图片组件 = 带头像的文本框组件`。

在这里，也鼓励大家能够将自己制作的组件模块——哪怕是练手用的或是摸鱼乱做的——分享出来，就会有人在你的工作的基础上做出更多的改进，对他人对自己都是很好的帮助。

## 前所未有的便捷开发

现有的开发方式是修改代码 --> 运行 --> 修改代码 --> 运行 --> ... 的无尽循环，AVG.js 将带来全新的实时游戏开发体验。

代码编辑器和浏览器运行同时进行，当你修改了一行代码，按下保存，浏览器将在下个瞬间实时更新你的修改——甚至可能连网页都没有刷新！

除此之外，React 和 Pixi.js 的 Chrome 调试工具对 AVG.js 也是有效的，你可以在浏览器中直接修改组件的坐标等参数来选择最佳方案，而无需五次三番地修改代码。


